<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <title>TopCoder TCO19 SRM 758 - 1000: PrettyLiar</title>
    
    <link type="image/x-icon" rel="shortcut icon" href="http://www.topcoder.com/i/favicon.ico"/>
    

    
    <style type="text/css">
        /* font */
body {
    font-family: Helvetica, Arial, Verdana, sans-serif;
    font-size: 16px;
    line-height: 1.2em;
}
ul.constraints > li:before, ul.notes > li:before {
    font-family: monospace;
    font-weight: normal;
}
.heading {
    font-weight: bold;
    font-size: 175%;
    line-height: 1.2em;
}
.section .section-title {
    font-weight: bold;
    font-size: 125%;
}
ol.testcases > li:before {
    font-family: monospace;
}
type {
    font-weight: bold;
    font-family: monospace;
}
li.testcase .data {
    font-family: monospace;
    line-height: 1.5em;
}

/* layout */
.heading {
    margin-top: 0.1em;
    margin-bottom:0.1em;
    text-align: center;
}
.section .section-title {
    margin-top : 1em;
    margin-bottom: 1em;
}
.problem-intro, note, user-constraint {
    padding-left: 1.25em;
}

/* Lists */
ul.constraints, ul.notes, ul.variables, ul.problem-definition-lines {
    list-style-type: none;
    padding: 0px;
}
ul.constraints > li:before {
    content: "-";
    position:relative;
    margin-left: 0px; /* optional, for multiline li element */
    left: 0.625em;
}
ul.notes > li:before {
    content: "-";
    position:relative;
    margin-left: 0px; /* optional, for multiline li element */
    left: 0.625em;
}

/* Testcases */
li.testcase {
    line-height: 1.1em;
    padding-top: 0.625em;
    padding-bottom: 0.625em;
    overflow: auto;
}
li.testcase > .testcase-content > div { padding-bottom: 0.5em; padding-left: 1em; }

li.testcase .testcase-comment {
    margin: 0;
    padding-left: 1em;
}
.testcase-comment p:first-child { margin-top: 0; }
.testcase-comment p:last-child { margin-bottom: 0; }

li.testcase .testcase-content {
    margin: 0.31em;
}

/* Data and variables */
.testcase-output {
    padding: 0.2em 1em 0.2em 0em;
}
.variables, .testcase-output {
    margin-left: 0.5em;
    display: table;
    margin-bottom: 0px;
    margin-top: 0px;
}
.variable {
    display: table-row;
}
.variable .name {
    padding: 0.2em 0em 0.2em 1em;
    font-weight: bold;
    display: table-cell;
    text-align: right;
}
.testcase-output .prefix {
    padding: 0.2em 0em 0.2em 1em;
    display: table-cell;
}
.testcase-output .prefix:after {
    content : ":";
    padding-right: 0.5em;
}
.variable .name:after {
    font-weight: bold;
    content : ":";
    padding-right: 0.5em;
}
.variable .value, .testcase-output .value {
    padding: 0.2em 1em 0.2em 0em;
    display: table-cell;
}
ol.testcases {
    padding: 0px;
    counter-reset: test_number -1;
}
ol.testcases > li {
    list-style:none;
}
ol.testcases > li:before {
    counter-increment:test_number;
    display: block;
    clear: both;
    content:counter(test_number) ")";
    color: inherit;
    background: inherit;
}

/* Problem Definition */
.problem-definition, .problem-limits {
    padding-left: 1.25em;
}
.problem-definition-lines, .limit-lines {
    display: table;
    margin-top: 0px;
    margin-bottom: 0px;
    padding-left: 0px;
}
.definition-line, .limit-line {
    display: table-row;
    height: 1.5em;
    overflow: auto;
}
.limit-name:after {
    content: ":";
    margin-right: 1em;
}
.definition-name, .definition-value, .limit-name, .limit-value {
    display: table-cell;
}
.definition-value {
    padding-left: 0.5em;
}
.definition-name:after {
    content: ":";
}
#contest-division:before {
    content: "Div ";
}
#problem-score:before {
    content: "- Problem ";
}
#problem-name {
    display: block;
}

/* Tags, hidden default */
.tag {
    visibility: hidden;
    position: absolute;
}

        body {
    /* font color */
    color: #CCCCCC;
    /* background color */
    background-color: #333333;
}
.section .section-title {
    /* title color */
    color: white;
}
li.testcase .data {
    /* highlight color */
    background: #303030;
}

    </style>
    
    
    

</head>

<body>
    <h1 class="heading">
        <span id='contest-name'>TCO19 SRM 758</span>
        
        <span id='problem-score'>1000</span>
        <span id='problem-name'>PrettyLiar</span>
    </h1>

    <hr />

    <!-- Problem Statement -->
    <div class="section">
        <h2 class="section-title">Problem Statement</h2>
        <div class="problem-intro">
            <intro escaped="1"><p><i>This problem has a non-standard time limit: 4 seconds.</i></p>
<p>Kaede and Kanade are good friends. Today they are going to play a game!</p>
<p>At the beginning of the game, each of them has a sequence of N positive integers. You are given these sequences in the <type>int[]</type>s <b>kaede</b> and <b>kanade</b>.</p>
<p>There is also a single pile of stones. At the beginning of the game the pile consists of <b>S</b> stones. It is guaranteed that <b>S</b> &lt;= sum(<b>kaede</b>) + sum(<b>kanade</b>).</p>
<p>During the game, the players take alternating turns removing some stones from the pile. Kaede takes the first turn. The game is completely deterministic. 
Each turn looks as follows:</p>
<ol>
<li>The player notes the value X of the first element of her sequence.</li>
<li>The player erases the first element of her sequence.</li>
<li>The player takes X stones from the pile (or all stones if there are fewer than X stones left).</li>
<li>If the pile just became empty, the player loses the game.</li>
</ol>
<p>Both girls call themselves &quot;pretty liars&quot;, so you should not be surprised that they are going to cheat: before the game, each girl will choose one of the N! possible permutations and use it to permute her sequence in secret.</p>
<p>You, watching the whole process, come up a question: How many of all (N!)^2 possible scenarios will end with Kaede winning the game?</p>
<p>Please compute and return the answer modulo 1,000,000,007.</p></intro>
        </div>
    </div>
    
    <!-- Problem definition -->
    
    <div class="section" id="definition">
        <h2 class="section-title">Definition</h2>
        <div class="problem-definition">
            <ul class="problem-definition-lines">
                <li class="definition-line" id='class-line'>
                    <span class='definition-name'>Class</span>
                    <span class='definition-value'>PrettyLiar</span>
                </li>
                <li class="definition-line" id='method-line'>
                    <span class='definition-name'>Method</span>
                    <span class='definition-value'>count</span>
                </li>
                <li class="definition-line" id='parameters-line'>
                    <span class='definition-name'>Parameters</span>
                    <span class='definition-value'>
                    
                        int
                    , 
                        vector&lt;int&gt;
                    , 
                        vector&lt;int&gt;
                    
                    </span>
                </li>
                <li class="definition-line" id='returns-line'>
                    <span class='definition-name'>Returns</span>
                    <span class='definition-value'>
                        int
                    </span>
                </li>
                <li class="definition-line" id='signature-line'>
                    <span class='definition-name'>Method signature</span>
                    <span class='definition-value'>
                        int count(int S, vector&lt;int&gt; kaede, vector&lt;int&gt; kanade)
                    </span>
                </li>
            </ul>
            <div class="problem-definition-public-tip">(be sure your method is public)</div>
        </div>        
    </div>
    

    <!-- Limits -->
    <div class="section">
        <h2 class="section-title">Limits</h2>
        <div class='problem-limits'>
            <ul class="limit-lines">
                <li class='limit-line'>
                    <span class='limit-name'>Time limit (s)</span>
                    <span class='limit-value'>4.000</span>
                </li>
                <li class='limit-line'>
                    <span class='limit-name'>Memory limit (MB)</span>
                    <span class='limit-value'>256</span>
                </li>
            </ul>
        </div>
    </div>

    
    <!-- Notes -->
    <div class="section">
        <h2 class="section-title">Notes</h2>
        <ul class="notes">
        
            <li><note escaped="1">The constraint on <b>S</b> ensures that one of the girls has to lose the game.</note></li>
        
        </ul>
    </div>
    
    
    <!-- Constraints -->
    <div class="section">
        <h2 class="section-title">Constraints</h2>
        <ul class="constraints">
        
            <li><user-constraint escaped="1">N will be between 1 and 100, inclusive.</user-constraint></li>
        
            <li><user-constraint escaped="1"><b>kaede</b> will contain exactly N elements.</user-constraint></li>
        
            <li><user-constraint escaped="1"><b>kanade</b> will contain exactly N elements.</user-constraint></li>
        
            <li><user-constraint escaped="1">Each element in <b>kaede</b> will be between 1 and 100, inclusive.</user-constraint></li>
        
            <li><user-constraint escaped="1">Each element in <b>kanade</b> will be between 1 and 100, inclusive.</user-constraint></li>
        
            <li><user-constraint escaped="1"><b>S</b> will be between 1 and 20,000, inclusive.</user-constraint></li>
        
            <li><user-constraint escaped="1"><b>S</b> will be less than or equal to the sum of elements in <b>kaede</b> and <b>kanade</b>.</user-constraint></li>
        
        </ul>
    </div>

    <!-- Test cases -->
    <div class="section">
        <h2 class="section-title">Test cases</h2>
        <ol class="testcases" start='0'>
            
            <li class="testcase">
                <div class="testcase-content">
                    <div class="testcase-input">
                        <div class='tag'>input</div>
                        <ul class="variables">
                        
                            <li class="variable data">
                                <span class="name data">S</span>
                                <span class="value data">
                                
                                    60
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kaede</span>
                                <span class="value data">
                                
                                    { 10, 40 }
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kanade</span>
                                <span class="value data">
                                
                                    { 20, 30 }
                                
                                </span>
                            </li>
                        
                        </ul>
                    </div>
                    <div class="testcase-output">
                        <div class='tag'>output</div>
                        <span class="prefix data">Returns</span>
                        <span class="value data">
                        
                            2
                        
                        </span>
                    </div>
                    
                    <div class="testcase-annotation">
                        <div class='tag'>note</div>
                        <div class="testcase-comment"><p>There are four possibilities:</p>
<ul>
<li><b>kaede</b>:{10,40} <b>kanade</b>:{20,30}</li>
<li><b>kaede</b>:{10,40} <b>kanade</b>:{30,20}</li>
<li><b>kaede</b>:{40,10} <b>kanade</b>:{20,30}</li>
<li><b>kaede</b>:{40,10} <b>kanade</b>:{30,20}</li>
</ul>
<p>In the first case the game will play out as follows:</p>
<ol>
<li>Kaede removes 10 stones from the pile. After the turn, Kaede's sequence is {40} and there are 50 stones left in the pile.</li>
<li>Kanade removes 20 stones from the pile. After the turn, Kanade's sequence is {30} and there are 30 stones left in the pile.</li>
<li>Kaede is supposed to take 40 stones. As there are only 30 stones left, she takes those 30 stones and loses the game. Hence, Kanade wins.</li>
</ol>
<p>Kaede wins in two out of the four possibilities listed above: the third and the fourth one. Thus, the correct return value is 2.</p></div>
                    </div>
                    
               
                </div>
            </li>
            
            <li class="testcase">
                <div class="testcase-content">
                    <div class="testcase-input">
                        <div class='tag'>input</div>
                        <ul class="variables">
                        
                            <li class="variable data">
                                <span class="name data">S</span>
                                <span class="value data">
                                
                                    100 
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kaede</span>
                                <span class="value data">
                                
                                    { 10, 40 }
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kanade</span>
                                <span class="value data">
                                
                                    { 20, 30 }
                                
                                </span>
                            </li>
                        
                        </ul>
                    </div>
                    <div class="testcase-output">
                        <div class='tag'>output</div>
                        <span class="prefix data">Returns</span>
                        <span class="value data">
                        
                            4
                        
                        </span>
                    </div>
                    
                    <div class="testcase-annotation">
                        <div class='tag'>note</div>
                        <div class="testcase-comment"><p>Regardless of how the girls permute their sequences, Kanade will always lose the game in her second turn. (Note that in this example <b>S</b> is exactly equal to the sum of all girls' numbers.)</p></div>
                    </div>
                    
               
                </div>
            </li>
            
            <li class="testcase">
                <div class="testcase-content">
                    <div class="testcase-input">
                        <div class='tag'>input</div>
                        <ul class="variables">
                        
                            <li class="variable data">
                                <span class="name data">S</span>
                                <span class="value data">
                                
                                    10 
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kaede</span>
                                <span class="value data">
                                
                                    { 10, 40 }
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kanade</span>
                                <span class="value data">
                                
                                    { 20, 30 }
                                
                                </span>
                            </li>
                        
                        </ul>
                    </div>
                    <div class="testcase-output">
                        <div class='tag'>output</div>
                        <span class="prefix data">Returns</span>
                        <span class="value data">
                        
                            0
                        
                        </span>
                    </div>
                    
                    <div class="testcase-annotation">
                        <div class='tag'>note</div>
                        <div class="testcase-comment"><p>In every case, Kaede loses in her first turn because <b>S</b> is equal to the smallest element in her sequence.</p></div>
                    </div>
                    
               
                </div>
            </li>
            
            <li class="testcase">
                <div class="testcase-content">
                    <div class="testcase-input">
                        <div class='tag'>input</div>
                        <ul class="variables">
                        
                            <li class="variable data">
                                <span class="name data">S</span>
                                <span class="value data">
                                
                                    25 
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kaede</span>
                                <span class="value data">
                                
                                    { 6, 14 }
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kanade</span>
                                <span class="value data">
                                
                                    { 7, 1 }
                                
                                </span>
                            </li>
                        
                        </ul>
                    </div>
                    <div class="testcase-output">
                        <div class='tag'>output</div>
                        <span class="prefix data">Returns</span>
                        <span class="value data">
                        
                            2
                        
                        </span>
                    </div>
                    
               
                </div>
            </li>
            
            <li class="testcase">
                <div class="testcase-content">
                    <div class="testcase-input">
                        <div class='tag'>input</div>
                        <ul class="variables">
                        
                            <li class="variable data">
                                <span class="name data">S</span>
                                <span class="value data">
                                
                                    178
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kaede</span>
                                <span class="value data">
                                
                                    { 25, 6, 14, 100, 71, 49 }
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kanade</span>
                                <span class="value data">
                                
                                    { 17, 7, 1, 100, 62, 43 }
                                
                                </span>
                            </li>
                        
                        </ul>
                    </div>
                    <div class="testcase-output">
                        <div class='tag'>output</div>
                        <span class="prefix data">Returns</span>
                        <span class="value data">
                        
                            240192
                        
                        </span>
                    </div>
                    
               
                </div>
            </li>
            
            <li class="testcase">
                <div class="testcase-content">
                    <div class="testcase-input">
                        <div class='tag'>input</div>
                        <ul class="variables">
                        
                            <li class="variable data">
                                <span class="name data">S</span>
                                <span class="value data">
                                
                                    1546 
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kaede</span>
                                <span class="value data">
                                
                                    { 50, 77, 74, 23, 43, 4, 57, 13, 50, 94, 43, 72, 94, 36, 20, 23, 27, 7, 3, 21, 16, 64, 28, 20, 2, 40, 92, 93, 17, 94, 43, 17, 1, 87, 58, 67, 43, 22, 99, 76, 13, 10, 45, 28, 2, 5, 37, 26, 76, 12 }
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kanade</span>
                                <span class="value data">
                                
                                    { 40, 93, 80, 23, 20, 71, 23, 14, 43, 45, 38, 20, 61, 84, 35, 9, 85, 71, 7, 21, 10, 42, 23, 20, 38, 73, 58, 97, 32, 3, 43, 99, 31, 39, 33, 73, 81, 3, 9, 73, 17, 68, 50, 27, 25, 86, 22, 47, 64, 8 }
                                
                                </span>
                            </li>
                        
                        </ul>
                    </div>
                    <div class="testcase-output">
                        <div class='tag'>output</div>
                        <span class="prefix data">Returns</span>
                        <span class="value data">
                        
                            949234178
                        
                        </span>
                    </div>
                    
               
                </div>
            </li>
            
            <li class="testcase">
                <div class="testcase-content">
                    <div class="testcase-input">
                        <div class='tag'>input</div>
                        <ul class="variables">
                        
                            <li class="variable data">
                                <span class="name data">S</span>
                                <span class="value data">
                                
                                    4
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kaede</span>
                                <span class="value data">
                                
                                    { 1, 1, 1, 1 }
                                
                                </span>
                            </li>
                        
                            <li class="variable data">
                                <span class="name data">kanade</span>
                                <span class="value data">
                                
                                    { 1, 1, 1, 1 }
                                
                                </span>
                            </li>
                        
                        </ul>
                    </div>
                    <div class="testcase-output">
                        <div class='tag'>output</div>
                        <span class="prefix data">Returns</span>
                        <span class="value data">
                        
                            576
                        
                        </span>
                    </div>
                    
                    <div class="testcase-annotation">
                        <div class='tag'>note</div>
                        <div class="testcase-comment">Each of the (N!)^2 ways to permute the two sequences is counted separately, even if different permutations produce the same sequences of numbers.</div>
                    </div>
                    
               
                </div>
            </li>
            
        </ol>
    </div>
    <hr />

    This problem statement is the exclusive and proprietary property of TopCoder, Inc. Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited. (c)2003, TopCoder, Inc. All rights reserved.
</body>
</html>
